//PR HubWProportions
match (pr:pull_request)--(pr2:pull_request)
with pr, collect(distinct pr2) as prs, collect(distinct pr2.user) as users
where size(prs) >= 3 and size(users) >= 2
call apoc.path.subgraphAll(pr, {limit: 50, bfs:true})
yield nodes, relationships
with pr, nodes, [1076, 18069, 1199, 862, 894, 1135, 1109, 1296, 1107, 1192, 1141, 1193, 1219, 1245, 1777, 1484, 1687, 1774, 1944, 2063, 1988, 1945, 2165, 4304, 2796, 2917, 2920, 3253, 2986, 2918, 5545, 5281, 4223, 3537, 3373, 4321, 3345, 3288, 3458, 3489, 3495, 3551, 6439, 4555, 4652, 4866, 4673, 4883, 5004, 4952, 5134, 5431, 5062, 5186, 5318, 5273, 5476, 8285, 5599, 6138, 6438, 6141, 6356, 5824, 5996, 6093, 6095, 6094, 6091, 6184, 6103, 6665, 6644, 6404, 6524, 6562, 6401, 6440, 6833, 6893, 6971, 6950, 6951, 7086, 7138, 7314, 7316, 13206, 20541, 7338, 7507, 7512, 7596, 17945, 7837, 8055, 8290, 8215, 8125, 8568, 8586, 8191, 8348, 11589, 8489, 8995, 9500, 9551, 9477, 10479, 10222, 11988, 12397, 12503, 13547, 12914, 13195, 19877, 13682, 14004, 14113, 14079, 14114, 14149, 9199, 14811, 16775, 16217, 16260, 16224, 19634, 19383, 19508, 19688, 19823, 20545, 20683, 20693, 20695, 20783, 20781, 20880, 20925, 20927, 20926, 20953, 20972, 20987, 22393, 21344, 21474, 21478, 22631, 22146, 22220, 22626, 22715, 22878, 24999, 24984, 24993, 24997, 25894, 26485, 26729, 27017, 27135, 27348, 28160, 27726, 29104, 28212, 28486, 28583, 28668, 28028, 29502, 29536, 30166, 29780, 30173, 30334, 31179, 32411, 31320, 33237, 34013, 31681, 31710, 31752, 32160, 35806, 35807, 31701, 32427, 35808, 33108, 33461, 34413, 33069, 36869, 39523, 39557, 39527, 39612, 39611, 39643, 39629, 39656, 39704, 39705, 39731, 40096, 39825, 39973, 39839, 39844, 39853, 39911, 39971, 40434, 40840, 41532, 43426, 43642, 43482, 43553, 43882, 43996, 44578, 44076, 44056, 44099, 44406, 44131, 44168, 44232, 44961, 45329, 45328, 45289, 45333, 45330, 45349, 45645, 45894, 46255, 51818, 53815, 54245, 53560, 53572, 53629, 53817, 53685, 53855, 53876, 54029, 54274, 54312, 54328, 54806, 54608, 54832, 55270, 55300, 55448, 55477, 55597, 55594, 56350, 61747, 61775, 61746, 61722, 61840, 61842, 61792, 61851, 61852, 61850, 61876, 61887, 61878, 62023, 62438, 62271, 62359, 62830, 62837, 63420, 63485, 63486, 63669, 64039, 64030, 64101, 64445, 64395, 64562, 64585, 64586, 64582, 64735, 65999, 67111, 68295, 68359, 68583, 68585, 68625, 68635, 69063, 68768, 68759, 68809, 68921, 68894, 68983, 69069, 69126, 69125, 69401, 69363, 69366, 69388, 69673, 71334, 71772, 71991, 71997, 72008, 72014, 72009, 74967, 77979, 76410, 78113, 77274, 77309, 77769, 77255, 79672, 79694, 79723, 80543, 80058, 80075, 80245, 80070, 80154, 80159, 80488, 80293, 80461, 80492, 80808, 80490, 80489, 80579, 80496, 80757, 80777, 80806, 80749, 80926, 80966, 81124, 81139, 80958, 81323, 81230, 81279, 81270, 81630, 81529, 82157, 83428, 84106, 84111, 84100, 84582, 84587, 84581, 84626, 84736, 85586, 85572, 85571, 86152, 85668, 85932, 89621, 85842, 86004, 85944, 85955, 86062, 86111, 86285, 86461, 86507, 86506, 86549, 86800, 87056, 87029, 88068, 87157, 87331, 87358, 87407, 87486, 87497, 87487, 87629, 89324, 87675, 87705, 87716, 87654, 87684, 88138, 88199, 87923, 88108, 88975, 88001, 88223, 88195, 88025, 88070, 90603, 88250, 88996, 88463, 88639, 88497, 89440, 88829, 89027, 89168, 89152, 89310, 89692, 89470, 89792, 90567, 89929, 89975, 90250, 90387, 90299, 90577, 90580, 90396, 90559, 90406, 90579, 90607, 90601, 90682, 91096, 91133, 91144, 91328, 91591, 91592, 92007, 91950, 92106, 92226, 92473, 92475, 92502, 92523, 92522, 92520, 92612, 92746, 92748] as known_pr_hubs
with pr, size(collect([i_node in nodes where i_node.type="pull_request" and i_node.number <> pr.number and not id(i_node) in known_pr_hubs])) as not_prhub, size(nodes) as len_nodes
return pr, toFloat(not_prhub) / toFloat(len_nodes) as proportion
